<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>chemistry &mdash; thermal_history  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="main" href="thermal_history.core_models.solid_FeS.main.html" />
    <link rel="prev" title="routines" href="thermal_history.core_models.solid_FeS.routines.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            thermal_history
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_example.html">Running a simple example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advanced.html">Adding new methods</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="API_index.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="thermal_history.html">thermal_history</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="thermal_history.core_models.html">core_models</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="thermal_history.core_models.leeds.html">leeds</a></li>
<li class="toctree-l4"><a class="reference internal" href="thermal_history.core_models.simple_test.html">simple_test</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="thermal_history.core_models.solid_FeS.html">solid_FeS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.mantle_models.html">mantle_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.stable_layer_models.html">stable_layer_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.thermal_history.html">thermal_history</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.utils.html">utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.model_classes.html">model_classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">thermal_history</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="API_index.html">API</a></li>
          <li class="breadcrumb-item"><a href="thermal_history.html">thermal_history</a></li>
          <li class="breadcrumb-item"><a href="thermal_history.core_models.html">core_models</a></li>
          <li class="breadcrumb-item"><a href="thermal_history.core_models.solid_FeS.html">solid_FeS</a></li>
          <li class="breadcrumb-item"><a href="thermal_history.core_models.solid_FeS.routines.html">routines</a></li>
      <li class="breadcrumb-item active">chemistry</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/thermal_history.core_models.solid_FeS.routines.chemistry.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chemistry">
<h1>chemistry<a class="headerlink" href="#chemistry" title="Link to this heading"></a></h1>
<p>(thermal_history.core_models.solid_FeS.routines.chemistry)</p>
<p id="module-thermal_history.core_models.solid_FeS.routines.chemistry">New function for the melting curve to use in place of the one in the ‘leeds’ core model.</p>
<dl class="py function">
<dt class="sig sig-object py" id="thermal_history.core_models.solid_FeS.routines.chemistry.melting_curve">
<span class="sig-name descname"><span class="pre">melting_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermal_history/core_models/solid_FeS/routines/chemistry.html#melting_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermal_history.core_models.solid_FeS.routines.chemistry.melting_curve" title="Link to this definition"></a></dt>
<dd><p>Calculates the melting curve and sets the mass fraction of light element in the solid iron core (conc_s) according to
the relevant partitioning model.
Different methods for the paramterisation of the melting curve can be set by the core_melting_params parameter.
In this parameter (a List), the first element is a string, followed by the constants (floats) required for the
parameterisation of conc_s and the melting curve. The accepted strings are currently:</p>
<p>‘AL’: This method is also the default if no string is given. Uses the method of Alfe et al. (2002) to determine conc_s
based on equal chemical potentials at the ICB and the depression of the iron melting point for the alloy. The iron melting temperature is calculated using
polynomials in pressure, with the coefficients given after ‘AL’ in core_melting_params.
E.g. = core_melting_params = [‘AL’, Tl0, Tl1, Tl2…..]</p>
<p>‘SG’: Uses the Simon-Glatzel parameterisation of the melting curve with fractionation of elements given by fixed
partitioning behaviour given by the partition_coeff parameter. After ‘SG’, the parameters required for the melting
curve are the constants Tl0, beta1 and beta2 (see Knibbe and Van Westrenen (2018) for details).
E.g. core_melting_params = [‘SG’, Tl0, beta1, beta2]</p>
<p>‘WN’: Uses the Williams and Nimmo (2004) parameterisation (also used in Davies and Pommier (2018)) for the melting curve.
Like ‘SG’, the partitioning is also described by fixed parition coefficients (=conc_s/conc_l) in the partition_coeff parameter.
After ‘WN’, the constants Tl0 and the polynomial coefficients in pressure should be given. E.g. in Davies and Pommier (2018)
this would be represented as core_melting_params = [‘WN’, Tl0, 1, Tl1, Tl2]</p>
<p>‘RI’: Uses a polynomial fit to Rivoldini’s EOS model. Polynomial coefficients are for both Pressure and Compositional dependence
and are calculated in the included stand-alone script riv_pre_compute_poly.py.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="thermal_history.model_classes.html#thermal_history.model_classes.ThermalModel" title="thermal_history.model_classes.ThermalModel"><em>ThermalModel</em></a>) – ThermalModel class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of 3 arrays for the melting point of iron, melting point of the alloy, and derivative of the alloy melting point with pressure.
Values are calculated on the same radial grid as all core profiles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(numpy.ndarray, numpy.ndarray, numpy.ndarray)</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an unrecognised string in core_melting_params is given.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thermal_history.core_models.solid_FeS.routines.chemistry.melting_temp_R18">
<span class="sig-name descname"><span class="pre">melting_temp_R18</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc_l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">melting_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/thermal_history/core_models/solid_FeS/routines/chemistry.html#melting_temp_R18"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermal_history.core_models.solid_FeS.routines.chemistry.melting_temp_R18" title="Link to this definition"></a></dt>
<dd><p>Melting curve of Ruckreimen et al. (2018) for S rich Fe-S alloys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>array</em>) – radial array for whole core</p></li>
<li><p><strong>P</strong> (<em>array</em>) – pressure array for whole core</p></li>
<li><p><strong>conc_l</strong> (<em>float</em>) – mass fraction of S</p></li>
<li><p><strong>melting_params</strong> (<em>array</em>) – parameters for melting temperature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Iron melting temperature and iron-sulphur alloy melting temperature.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(array, array)</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="thermal_history.core_models.solid_FeS.routines.html" class="btn btn-neutral float-left" title="routines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="thermal_history.core_models.solid_FeS.main.html" class="btn btn-neutral float-right" title="main" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Sam Greenwood.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>