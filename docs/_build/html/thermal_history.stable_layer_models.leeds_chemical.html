

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>leeds_chemical &mdash; thermal_history  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="routines" href="thermal_history.stable_layer_models.leeds_chemical.routines.html" />
    <link rel="prev" title="main" href="thermal_history.stable_layer_models.FeS.main.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> thermal_history
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_example.html">Running a simple example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advanced.html">Adding new methods</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="API_index.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="thermal_history.html">thermal_history</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="thermal_history.core_models.html">core_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.mantle_models.html">mantle_models</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="thermal_history.stable_layer_models.html">stable_layer_models</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="thermal_history.stable_layer_models.FeS.html">FeS</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">leeds_chemical</a></li>
<li class="toctree-l4"><a class="reference internal" href="thermal_history.stable_layer_models.leeds_thermal.html">leeds_thermal</a></li>
<li class="toctree-l4"><a class="reference internal" href="thermal_history.stable_layer_models.solid_FeS.html">solid_FeS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.thermal_history.html">thermal_history</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.utils.html">utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.model_classes.html">model_classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">thermal_history</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="API_index.html">API</a> &raquo;</li>
        
          <li><a href="thermal_history.html">thermal_history</a> &raquo;</li>
        
          <li><a href="thermal_history.stable_layer_models.html">stable_layer_models</a> &raquo;</li>
        
      <li>leeds_chemical</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/thermal_history.stable_layer_models.leeds_chemical.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="leeds-chemical">
<h1>leeds_chemical<a class="headerlink" href="#leeds-chemical" title="Permalink to this heading">¶</a></h1>
<p>(thermal_history.stable_layer_models.leeds_chemical)</p>
<span class="target" id="module-thermal_history.stable_layer_models.leeds_chemical"></span><section class="tex2jax_ignore mathjax_ignore" id="overview">
<h2>Overview:<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>Stable layer model for chemical stratification of Davies and Greenwood (2022). This model uses the method of Buffett and Seagle (2010) to grow the layer, with extensions to calculate the energy/entropy balance and couple to the rest of the core. The temperature profile is also found by solving the diffusion solution, with the thermal gradient at <code class="docutils literal notranslate"><span class="pre">rs</span></code> controlling the lower chemical boundary condition. Whilst multiple light elements may be present in the iron alloy, only 1 is treated as controlling the stable layer (the light element represented by the first value in the <code class="docutils literal notranslate"><span class="pre">conc_l</span></code> array). Others are assumed to match their uniform values in the bulk. This model must be used in conjunction with a core model.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="expected-attributes-of-other-regions">
<h2>Expected attributes of other regions:<a class="headerlink" href="#expected-attributes-of-other-regions" title="Permalink to this heading">¶</a></h2>
<p>Core must have the following attributes (i.e. model.core.X</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rs</span></code></p></td>
<td><p>Radius of the stable layer interface</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Tcen</span></code></p></td>
<td><p>The core temperature at its center</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dT_dt</span></code></p></td>
<td><p>Rate of change of ‘Tcen’</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">conc_l</span></code></p></td>
<td><p>Array of light element mass fractions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dc_dt</span></code></p></td>
<td><p>Rate of change of ‘conc_l’</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">profiles</span></code></p></td>
<td><p>A dictionary of radial core profiles</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Qs</span></code></p></td>
<td><p>Secular cooling to add on the contribution from the stable layer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Es,</span> <span class="pre">Ej,</span> <span class="pre">Ek,</span> <span class="pre">'Ea</span></code></p></td>
<td><p>Entropy terms to add on the contribution from the stable layer</p></td>
</tr>
</tbody>
</table>
<p>Mantle must have the following attributes (i.e. model.mantle.X):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Q_cmb</span></code></p></td>
<td><p>Heat flow across Core-Mantle Boundary</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">chemical_bc_cmb</span></code></p></td>
<td><p>Chemical boundary conditions for core stable layer solution</p></td>
</tr>
</tbody>
</table>
<p>If not using a mantle model, <code class="docutils literal notranslate"><span class="pre">Q_cmb</span></code> and <code class="docutils literal notranslate"><span class="pre">chemical_bc_cmb</span></code> must be set manually, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thermal_history.model</span> <span class="kn">import</span> <span class="n">Parameters</span><span class="p">,</span> <span class="n">setup_model</span>

<span class="c1">#Load parameters and setup model</span>
<span class="n">prm</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">(</span><span class="s1">&#39;/path/to/parameters_file&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">setup_model</span><span class="p">(</span><span class="n">prm</span><span class="p">,</span> <span class="n">core_method</span><span class="o">=</span><span class="s1">&#39;leeds&#39;</span><span class="p">,</span> <span class="n">stable_layer_method</span><span class="o">=</span><span class="s1">&#39;leeds_chemical&#39;</span><span class="p">)</span>

<span class="c1">#Evolve model</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1e6</span><span class="o">*</span><span class="n">prm</span><span class="o">.</span><span class="n">ys</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">mantle</span><span class="o">.</span><span class="n">Q_cmb</span> <span class="o">=</span> <span class="mf">1e12</span> <span class="c1">#Set CMB heat flow.</span>
    <span class="c1">#Chemical boundary conditions (1/0, float).</span>
    <span class="c1">#1/0 indicates fixed flux or fixed value, then provide the value of the boundary condition.</span>
    <span class="n">model</span><span class="o">.</span><span class="n">mantle</span><span class="o">.</span><span class="n">chemical_bc_cmb</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1">#Zero flux BC.</span>
    <span class="n">model</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

</pre></div>
</div>
<section id="note-some-key-modelling-assumptions">
<h3>Note some key modelling assumptions:<a class="headerlink" href="#note-some-key-modelling-assumptions" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>A minimum chemical gradient is assumed at <code class="docutils literal notranslate"><span class="pre">rs</span></code> of <span class="math notranslate nohighlight">\(10^-10 \mathrm{m}^{-1}\)</span> to ensure numerical stability. Lower values than this threshold arrise from heat flows approaching or below the adiabatic heat flow at the CMB. In such a case, thermal stratification can begin to grow and would likely outpace the chemical layer. A chemical layer embedded within a thermal layer may then be the appropriate core structure. There is a stable layer method, `leeds_thermochemical’, under development that attempts to account for such a scenario. However, it to date has not been used in any publication.</p></li>
<li><p>As mentioned above, only 1 light element is assumed to diffuse in the stable layer. The light element represented by the first value in the <code class="docutils literal notranslate"><span class="pre">model.core.conc_l</span></code> array (and subsequently any other arrays relating to light elements e.g. <code class="docutils literal notranslate"><span class="pre">dc_dt</span></code>) is solved for in the stable layer. All others are equal to the homogenous interior values.</p></li>
</ol>
</section>
<section id="references">
<h3>References:<a class="headerlink" href="#references" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Buffett, B.A. and Seagle, C.T., 2010. Stratification of the top of the core due to chemical interactions with the mantle. Journal of Geophysical Research: Solid Earth, 115(B4).</p></li>
<li><p>Davies, C.J. &amp; Greenwood, S. 2022. Dynamics in Earth’s core arising from thermo-chemical interactions with the mantle. In: Core-Mantle coevolution – A multidisciplinary approach. Wiley. (In Press). (Accepted).</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<p>Packages:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="thermal_history.stable_layer_models.leeds_chemical.routines.html">routines</a></li>
</ul>
</div>
<p>Modules:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="thermal_history.stable_layer_models.leeds_chemical.main.html">main</a></li>
</ul>
</div>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="thermal_history.stable_layer_models.leeds_chemical.routines.html" class="btn btn-neutral float-right" title="routines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="thermal_history.stable_layer_models.FeS.main.html" class="btn btn-neutral float-left" title="main" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Sam Greenwood

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>