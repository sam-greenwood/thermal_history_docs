

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FeS &mdash; thermal_history  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="main" href="thermal_history.stable_layer_models.FeS.main.html" />
    <link rel="prev" title="stable_layer_models" href="thermal_history.stable_layer_models.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> thermal_history
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="README.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="simple_example.html">Running a simple example</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advanced.html">Adding new methods</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="API_index.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="thermal_history.html">thermal_history</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="thermal_history.core_models.html">core_models</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.mantle_models.html">mantle_models</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="thermal_history.stable_layer_models.html">stable_layer_models</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">FeS</a></li>
<li class="toctree-l4"><a class="reference internal" href="thermal_history.stable_layer_models.leeds_chemical.html">leeds_chemical</a></li>
<li class="toctree-l4"><a class="reference internal" href="thermal_history.stable_layer_models.leeds_thermal.html">leeds_thermal</a></li>
<li class="toctree-l4"><a class="reference internal" href="thermal_history.stable_layer_models.solid_FeS.html">solid_FeS</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.thermal_history.html">thermal_history</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.utils.html">utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.model.html">model</a></li>
<li class="toctree-l3"><a class="reference internal" href="thermal_history.model_classes.html">model_classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">thermal_history</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="API_index.html">API</a> &raquo;</li>
        
          <li><a href="thermal_history.html">thermal_history</a> &raquo;</li>
        
          <li><a href="thermal_history.stable_layer_models.html">stable_layer_models</a> &raquo;</li>
        
      <li>FeS</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/thermal_history.stable_layer_models.FeS.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="fes">
<h1>FeS<a class="headerlink" href="#fes" title="Permalink to this heading">¶</a></h1>
<p>(thermal_history.stable_layer_models.FeS)</p>
<span class="target" id="module-thermal_history.stable_layer_models.FeS"></span><section class="tex2jax_ignore mathjax_ignore" id="overview">
<h2>Overview:<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>Development model for a liquid FeS layer embedded in a bulk Fe-Si core. 2 methods are included for testing during development, which can be specified using the parameter <code class="docutils literal notranslate"><span class="pre">FeS_method</span></code> set to the string <code class="docutils literal notranslate"><span class="pre">conducting</span></code> or <code class="docutils literal notranslate"><span class="pre">isothermal</span></code>. The isothermal model assumes that the FeS layer convects and is isothermal. The bulk core can thermally stratify beneath it. The conducting model assumes the FeS layer is always conducting and the bulk core can also thermally stratify beneath it. Note the core model <code class="docutils literal notranslate"><span class="pre">FeS</span></code> must also be used in conjunction with this stable layer model.</p>
<p>For the isothermal model, when the bulk is fully convecting, the heat flow into the FeS layer is not yet known when the evolve method of the core model is called. Instead an adiabatic heat flow is assumed and then when this stable layer method is called, the cooling rate (and all associated rates of change) are adjusted for the correct amount of cooling taking into account the liquid FeS. When the bulk is thermally stratified, the upper boundary on the diffusion solution is fixed in temperature to the bottom of the FeS layer. The heat flow from the bulk into the FeS layer is calculated from the thermal gradient at the top of the bulk core. This heat flow then is used to calculate the cooling rate of the FeS layer in the next iteration.</p>
<p>For the conducting model, when the bulk is fully convecting, the conduction solution for the FeS layer is fixed to the adiabat at it’s lower boundary. The heat flow from the bulk into the FeS layer is then calculated from the thermal gradient at the base of the FeS layer, used for calculating the cooling rate of the core in the next iteration.</p>
<p>When both models have thermal stratification in the bulk, the boundary condition at the base of the thermal layer and the method for advancing the layer deeper into the core is the same as the <code class="docutils literal notranslate"><span class="pre">leeds_thermal</span></code> method.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="expected-attributes-of-other-regions">
<h2>Expected attributes of other regions:<a class="headerlink" href="#expected-attributes-of-other-regions" title="Permalink to this heading">¶</a></h2>
<p>Core must have the following attributes (i.e. model.core.X):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">rs</span></code></p></td>
<td><p>Radius of the stable layer interface</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Tcen</span></code></p></td>
<td><p>The core temperature at its center</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dT_dt</span></code></p></td>
<td><p>Rate of change of ‘Tcen’</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">profiles</span></code></p></td>
<td><p>A dictionary of radial core profiles (see leeds core model)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Qs</span></code></p></td>
<td><p>Secular cooling to add on the contribution from the stable layer</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Es,</span> <span class="pre">Ej,</span> <span class="pre">Ek</span></code></p></td>
<td><p>Entropy terms to add on the contribution from the stable layer</p></td>
</tr>
</tbody>
</table>
<p>Mantle must have the following attributes (i.e. model.mantle.X):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Attribute</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Q_cmb</span></code></p></td>
<td><p>Heat flow across Core-Mantle Boundary</p></td>
</tr>
</tbody>
</table>
<p>If not using a mantle model, <code class="docutils literal notranslate"><span class="pre">Q_cmb</span></code> must be set manually, e.g.:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thermal_history.model</span> <span class="kn">import</span> <span class="n">Parameters</span><span class="p">,</span> <span class="n">setup_model</span>

<span class="c1">#Load parameters and setup model</span>
<span class="n">prm</span> <span class="o">=</span> <span class="n">Parameters</span><span class="p">(</span><span class="s1">&#39;/path/to/parameters_file&#39;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">setup_model</span><span class="p">(</span><span class="n">prm</span><span class="p">,</span> <span class="n">core_method</span><span class="o">=</span><span class="s1">&#39;FeS&#39;</span><span class="p">,</span> <span class="n">stable_layer_method</span><span class="o">=</span><span class="s1">&#39;FeS&#39;</span><span class="p">)</span>

<span class="c1">#Evolve model</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">1e6</span><span class="o">*</span><span class="n">prm</span><span class="o">.</span><span class="n">ys</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">mantle</span><span class="o">.</span><span class="n">Q_cmb</span> <span class="o">=</span> <span class="mf">1e12</span> <span class="c1">#Set CMB heat flow.</span>
    <span class="n">model</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

</pre></div>
</div>
<section id="note-some-key-modelling-assumptions">
<h3>Note some key modelling assumptions:<a class="headerlink" href="#note-some-key-modelling-assumptions" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>For the conducting method, the diffusion solution for calculating the temperature profile when a discontinuity in thermal conductivity also assumes that the density, specific heat and thermal conductivity are constant in radius for each region (bulk and FeS layer). A critical warning will be logged is this is not adhered to with the input parameters. This restriction should be relatively easy to relax, just need the discretisation scheme in <code class="docutils literal notranslate"><span class="pre">.routines.diffusion.diffusion_discont</span></code> to account for it as <code class="docutils literal notranslate"><span class="pre">.routines.diffusion.diffusion_uneven</span></code> does.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<p>Modules:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="thermal_history.stable_layer_models.FeS.main.html">main</a></li>
</ul>
</div>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="thermal_history.stable_layer_models.FeS.main.html" class="btn btn-neutral float-right" title="main" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="thermal_history.stable_layer_models.html" class="btn btn-neutral float-left" title="stable_layer_models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Sam Greenwood

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>